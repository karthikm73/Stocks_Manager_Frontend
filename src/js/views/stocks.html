<link rel="stylesheet" href="../../css/stock-page.css">
<div class="oj-hybrid-padding">
  <h1>Stock Page</h1>

  <div data-bind="visible:isAdmin">

    <!-- BUTTONS FOR ACTION -->
    <button data-bind="click: addStock">Add Stock</button>

    <button data-bind="click: deleteStock">Delete Stock</button>

    <button data-bind="click: listStock">List Stock</button>

    <button data-bind="click: updateStock">Update Stock</button>
    <!-- BUTTONS FOR ACTION END -->

    <!-- START OF ADD STOCK -->
    <!-- START OF ADD STOCK -->
    <div data-bind="visible: showAddStock" class="add-stock-form">
      <h3>Add Stock</h3>
      <label>Stock Name:</label>
      <input type="text" data-bind="value: name" required />

      <label>Price:</label>
      <input type="number" data-bind="value: price" required />

      <label>Volume:</label>
      <input type="number" data-bind="value: volume" required />

      <label>Listed Exchange:</label>
      <select data-bind="value: listedExchange" required>
        <option value="">Select Exchange</option>
        <option value="BSE">BSE</option>
        <option value="NSE">NSE</option>
      </select>

      <label>Listed Date:</label>
      <input type="date" data-bind="value: listedDate" required />

      <label>Listing Price:</label>
      <input type="number" data-bind="value: listingPrice" required />

      <div class="form-actions">
        <button data-bind="click: submitStock, enable: isFormValid">Submit</button>
      </div>
    </div>
    <!-- END OF ADD STOCK -->

    <!-- START LIST ALL STOCKS -->
    <div data-bind="visible : showAllStock">
      <h3>All Stock</h3>

      <table border="1" cellpadding="8" cellspacing="0">
        <thead>
          <tr>
            <th>Stock ID</th>
            <th>Stock Name</th>
            <th>Stock Price</th>
            <th>Stock Volume</th>
            <th>Listed Exchange</th>
            <th>Listed Date</th>
            <th>Listed Price</th>
          </tr>
        </thead>
        <tbody data-bind="foreach: stocks">
          <tr>
            <td data-bind="text: stockId"></td>
            <td data-bind="text: name"></td>
            <td data-bind="text: price"></td>
            <td data-bind="text: volume"></td>
            <td data-bind="text: listedExchange"></td>
            <td data-bind="text: listedDate"></td>
            <td data-bind="text:listingPrice"></td>
        </tbody>
      </table>
    </div>
    <!-- END OF LIST ALL STOCK -->

    <!-- START DELETE STOCK -->
    <div data-bind="visible : showDeleteStock">
      <h3>Delete Stock</h3>

      <table border="1" cellpadding="8" cellspacing="0">
        <thead>
          <tr>
            <th>Stock ID</th>
            <th>Stock Name</th>
            <th>Stock Price</th>
            <th>Stock Volume</th>
            <th>Listed Exchange</th>
            <th>Listed Date</th>
            <th>Listed Price</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody data-bind="foreach: stocks">
          <tr>
            <td data-bind="text: stockId"></td>
            <td data-bind="text: name"></td>
            <td data-bind="text: price"></td>
            <td data-bind="text: volume"></td>
            <td data-bind="text: listedExchange"></td>
            <td data-bind="text: listedDate"></td>
            <td data-bind="text:listingPrice"></td>
            <button data-bind="click: function() { $parent.deleteStockById(stockId) }">Delete</button>
          </tr>
        </tbody>
      </table>
    </div>
    <!-- END OF DELETE STOCK -->

    <!-- START UPDATE STOCK -->
    <div data-bind="visible: showUpdateStock">
      <h3>Update Stocks</h3>
      <table border="1" cellpadding="8" cellspacing="0">
        <thead>
          <tr>
            <th>Stock ID</th>
            <th>Stock Name</th>
            <th>Stock Price</th>
            <th>Stock Volume</th>
            <th>Listed Exchange</th>
            <th>Listed Date</th>
            <th>Listed Price</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody data-bind="foreach: stocks">
          <tr>
            <td data-bind="text: stockId"></td>
            <td><input type="text" data-bind="value: name" /></td>
            <td><input type="number" data-bind="value: price" /></td>
            <td><input type="number" data-bind="value: volume" /></td>
            <td>
              <select data-bind="value: listedExchange">
                <option value="BSE">BSE</option>
                <option value="NSE">NSE</option>
              </select>
            </td>
            <td><input type="date" data-bind="value: listedDate" /></td>
            <td><input type="number" data-bind="value: listingPrice" /></td>
            <td>
              <button data-bind="click: function() { $parent.updateStockById($data,stockId) }">Update</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <!-- END UPDATE STOCK -->
  </div>

  <div data-bind="visible:!isAdmin()">
    <button data-bind="click: listStock">List Stocks</button>
    <button data-bind="click: listMyStocks">My Stocks</button>

    <!-- START OF ALL STOCKS -->
    <div data-bind="visible : showAllStock">
      <h3>All Stock</h3>

      <table border="1" cellpadding="8" cellspacing="0">
        <thead>
          <tr>
            <th>Stock ID</th>
            <th>Stock Name</th>
            <th>Stock Price</th>
            <th>Stock Volume</th>
            <th>Listed Exchange</th>
            <th>Listed Date</th>
            <th>Listed Price</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody data-bind="foreach: stocks">
          <tr>
            <td data-bind="text: stockId"></td>
            <td data-bind="text: name"></td>
            <td data-bind="text: price"></td>
            <td data-bind="text: volume"></td>
            <td data-bind="text: listedExchange"></td>
            <td data-bind="text: listedDate"></td>
            <td data-bind="text:listingPrice"></td>
            <td>
              <!-- BUY example for customer -->
              <button data-bind="click: function() { showQuantity(true) }, visible: !showQuantity()">Buy</button>
              <div data-bind="visible: showQuantity">
                <input type="number" min="1" placeholder="Enter qty" data-bind="value: quantity" />
                <button data-bind="click: function() { $parent.buyStockById($data, quantity()) }">Confirm</button>
              </div>
            </td>


        </tbody>
      </table>
    </div>
    <!-- END OF LIST ALL STOCK -->

    <!-- START OF MY STOCK -->

    <div data-bind="visible: showMyAllStock">
      <h1>My Stocks</h1>
      <div>
        <h3>Total Asset Value: <span data-bind="text: totalAssetValue"></span></h3>
      </div>
      <!-- Table shown only if stocks exist -->
      <div data-bind="visible: stocks().length > 0">

        <table border="1" cellpadding="8" cellspacing="0">
          <thead>
            <tr>
              <th>Stock ID</th>
              <th>Stock Name</th>
              <th>Stock Price</th>
              <th>Stock Volume</th>
              <th>Listed Exchange</th>
              <th>Listed Date</th>
              <th>Listed Price</th>
              <th>Quantity</th>
              <th>Asset Value</th>

              <th>Action</th>
            </tr>
          </thead>
          <tbody data-bind="foreach: stocks">
            <tr>
              <td data-bind="text: stockId"></td>
              <td data-bind="text: name"></td>
              <td data-bind="text: price"></td>
              <td data-bind="text: volume"></td>
              <td data-bind="text: listedExchange"></td>
              <td data-bind="text: listedDate"></td>
              <td data-bind="text: listingPrice"></td>
              <td data-bind="text: $data.qty"></td>
              <td data-bind="text: assetValue"></td>

              <td>
                <!-- Buy button shows input when clicked -->
                <button data-bind="click: function() { showQuantity(true) }, visible: !showQuantity()">SELL</button>
                <div data-bind="visible: showQuantity">
                  <input type="number" min="1" placeholder="Enter qty" data-bind="value: quantity" />
                  <button data-bind="click: function() { $parent.sellStockById($data, quantity()) }">Confirm</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Message when stocks are empty -->
      <div data-bind="visible: stocks().length === 0">
        <p>You have not bought any stocks.</p>
      </div>
    </div>

    <!-- END OF MY STOCK -->

  </div>


</div>